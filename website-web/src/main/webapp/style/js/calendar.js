var calendar_={};calendar_.config={today:"今天",d:"日",mm:"月",yy:"年",mm_pre:"上一月",mm_next:"下一月",mm_click:"点击选择月份",yy_click:"点击选择年份",year_start:2000,year_end:2029,monday:"一",tuesday:"二",wendesday:"三",thursday:"四",friday:"五",saturday:"六",sunday:"日",today_class:"cal_today",chk_class:"cal_checked",exp_class:"cal_expire",def_class:"cal_default"};var ie=navigator.appName=="Microsoft Internet Explorer"?true:false;function $id(a){return document.getElementById(a)}var controlid=null;var currdate=null;var startdate=null;var enddate=null;var yy=null;var mm=null;var hh=null;var ii=null;var currday=null;var today=new Date();var lastcheckedyear=false;var lastcheckedmonth=false;function _cancelBubble(a){e=a?a:window.event;if(ie){e.cancelBubble=true}else{e.stopPropagation()}}function getposition(b){var a=new Array();a.x=b.offsetLeft;a.y=b.offsetTop;while(b=b.offsetParent){a.x+=b.offsetLeft;a.y+=b.offsetTop}return a}function loadcalendar(){s="";s+='<div id="calendar" style="display:none; position:absolute; z-index:9;" onclick="_cancelBubble(event)">';if(ie){s+='<iframe class="cal_iframe" src="about:blank"></iframe>'}s+='<div class="calendar_table"><table cellspacing="0" cellpadding="0" width="100%">';s+='<tr align="center" class="calendar_hd"><th class="calendar_left"><a href="###" onclick="refreshcalendar(yy, mm-1);return false" title="'+calendar_.config.mm_pre+'">&lt;&lt;</a></th><th colspan="5" style="text-align: center" class="calendar_yymm"><a href="#" onclick="showdiv(\'year\');_cancelBubble(event);return false" title="'+calendar_.config.yy_click+'" id="year"></a><span class="cal_spl">-</span><a id="month" title="'+calendar_.config.mm_click+'" href="###" onclick="showdiv(\'month\');_cancelBubble(event);return false"></a></th><th class="calendar_right"><a href="###"   onclick="refreshcalendar(yy, mm+1);return false" title="'+calendar_.config.mm_pre+'">&gt;&gt;</a></th></tr>';s+='<tr class="category"><td>'+calendar_.config.sunday+"</td><td>"+calendar_.config.monday+"</td><td>"+calendar_.config.tuesday+"</td><td>"+calendar_.config.wendesday+"</td><td>"+calendar_.config.thursday+"</td><td>"+calendar_.config.friday+"</td><td>"+calendar_.config.saturday+"</td></tr>";for(var d=0;d<6;d++){s+='<tr class="cal_tr">';for(var b=1;b<=7;b++){s+="<td id=d"+(d*7+b)+">&nbsp;</td>"}s+="</tr>"}s+='<tr class="curShowToday"><td colspan="7" id="curShowToday"></td></tr>';s+="</table></div></div>";s+='<div id="calendar_year" class="calendar_select" onclick="_cancelBubble(event)"><div class="col">';for(var a=calendar_.config.year_start;a<=calendar_.config.year_end;a++){s+=a!=calendar_.config.year_start&&a%10==0?'</div><div class="col">':"";s+='<a href="###" onclick="refreshcalendar('+a+", mm);$id('calendar_year').style.display='none';return false\"><span"+(today.getFullYear()==a?' class="today"':"")+' id="calendar_year_'+a+'">'+a+"</span></a>"}s+="</div></div>";s+='<div id="calendar_month"  class="calendar_select" onclick="_cancelBubble(event)">';for(var a=1;a<=12;a++){s+='<a href="#" onclick="refreshcalendar(yy, '+(a-1)+");$id('calendar_month').style.display='none';return false\"><span"+(today.getMonth()+1==a?' class="today"':"")+' id="calendar_month_'+a+'">'+a+(a<10?" ":"")+calendar_.config.mm+"</span></a>"}s+="</div>";var c=document.createElement("div");c.innerHTML=s;document.getElementsByTagName("body")[0].appendChild(c);document.onclick=function(f){$id("calendar").style.display="none";$id("calendar_year").style.display="none";$id("calendar_month").style.display="none"};$id("calendar").onclick=function(f){_cancelBubble(f);$id("calendar_year").style.display="none";$id("calendar_month").style.display="none"}}function parsedate(f){/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec(f);var d=(RegExp.$1&&RegExp.$1>1899&&RegExp.$1<2101)?parseFloat(RegExp.$1):today.getFullYear();var c=(RegExp.$2&&(RegExp.$2>0&&RegExp.$2<13))?parseFloat(RegExp.$2):today.getMonth()+1;var b=(RegExp.$3&&(RegExp.$3>0&&RegExp.$3<32))?parseFloat(RegExp.$3):today.getDate();var a=(RegExp.$4&&(RegExp.$4>-1&&RegExp.$4<24))?parseFloat(RegExp.$4):0;var g=(RegExp.$5&&(RegExp.$5>-1&&RegExp.$5<60))?parseFloat(RegExp.$5):0;/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec("0000-00-00 00:00");return new Date(d,c-1,b,a,g)}function settime(c,b,a){$id("calendar").style.display="none";controlid.value=c+"-"+zerofill(b+1)+"-"+zerofill(a)}function rftCalendar(b,f,d,a){controlid=f;startdate=d?parsedate(d):false;enddate=a?parsedate(a):false;currday=controlid.value?parsedate(controlid.value):today;hh=currday.getHours();ii=currday.getMinutes();var c=getposition(controlid);$id("calendar").style.display="block";$id("calendar").style.left=c.x+"px";$id("calendar").style.top=(c.y+20)+"px";_cancelBubble(b);refreshcalendar(currday.getFullYear(),currday.getMonth());if(lastcheckedyear!=false){$id("calendar_year_"+lastcheckedyear).className=calendar_.config.def_class;$id("calendar_year_"+today.getFullYear()).className=calendar_.config.today_class}if(lastcheckedmonth!=false){$id("calendar_month_"+lastcheckedmonth).className=calendar_.config.def_class;$id("calendar_month_"+(today.getMonth()+1)).className=calendar_.config.today_class}$id("calendar_year_"+currday.getFullYear()).className=calendar_.config.chk_class;$id("calendar_month_"+(currday.getMonth()+1)).className=calendar_.config.chk_class;lastcheckedyear=currday.getFullYear();lastcheckedmonth=currday.getMonth()+1}function refreshcalendar(j,f){var c=new Date(j,f,1);var b=c.getDay();var h=c.getDate();var a=null;yy=c.getFullYear();mm=c.getMonth();$id("year").innerHTML=yy+calendar_.config.yy;$id("month").innerHTML=mm+1+calendar_.config.mm;for(var g=1;g<=b;g++){a=$id("d"+g);a.innerHTML=" ";a.className=""}while(c.getMonth()==mm){a=$id("d"+(h+b));a.innerHTML='<a href="###" onclick="settime('+yy+","+mm+","+h+');return false">'+h+"</a>";if(c.getTime()<today.getTime()||(enddate&&c.getTime()>enddate.getTime())||(startdate&&c.getTime()<startdate.getTime())){a.className=calendar_.config.exp_class}else{a.className=calendar_.config.def_class}if(c.getFullYear()==today.getFullYear()&&c.getMonth()==today.getMonth()&&c.getDate()==today.getDate()){a.className=calendar_.config.today_class;a.firstChild.title=calendar_.config.today;$id("curShowToday").innerHTML='<a href="###" onclick="settime('+yy+","+mm+","+h+');return false">'+calendar_.config.today+":"+yy+calendar_.config.yy+(mm+1)+calendar_.config.mm+h+calendar_.config.d+"</a>"}if(c.getFullYear()==currday.getFullYear()&&c.getMonth()==currday.getMonth()&&c.getDate()==currday.getDate()){a.className=calendar_.config.chk_class}c.setDate(++h)}while(h+b<=42){a=$id("d"+(h+b));a.innerHTML=" ";h++}}function showdiv(b){var a=getposition($id(b));$id("calendar_"+b).style.left=a.x+"px";$id("calendar_"+b).style.top=(a.y+26)+"px";$id("calendar_"+b).style.display="block"}function zerofill(a){var a=parseFloat(a.toString().replace(/(^[\s0]+)|(\s+$)/g,""));a=isNaN(a)?0:a;return(a<10?"0":"")+a.toString()};